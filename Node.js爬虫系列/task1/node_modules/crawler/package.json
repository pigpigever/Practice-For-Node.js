{
  "_args": [
    [
      {
        "raw": "crawler",
        "scope": null,
        "escapedName": "crawler",
        "name": "crawler",
        "rawSpec": "",
        "spec": "latest",
        "type": "tag"
      },
      "/home/ggboy/文档/repositories/Practice-For-Node.js/Node.js爬虫系列/task1"
    ]
  ],
  "_from": "crawler@latest",
  "_id": "crawler@1.0.5",
  "_inCache": true,
  "_location": "/crawler",
  "_nodeVersion": "6.9.1",
  "_npmOperationalInternal": {
    "host": "packages-12-west.internal.npmjs.com",
    "tmp": "tmp/crawler-1.0.5.tgz_1494417107443_0.3716903864406049"
  },
  "_npmUser": {
    "name": "mike442144",
    "email": "mike442144@hotmail.com"
  },
  "_npmVersion": "3.10.8",
  "_phantomChildren": {},
  "_requested": {
    "raw": "crawler",
    "scope": null,
    "escapedName": "crawler",
    "name": "crawler",
    "rawSpec": "",
    "spec": "latest",
    "type": "tag"
  },
  "_requiredBy": [
    "#USER",
    "/"
  ],
  "_resolved": "http://registry.npmjs.org/crawler/-/crawler-1.0.5.tgz",
  "_shasum": "3a95f1bff46763e57ee6161d012b967f8e771684",
  "_shrinkwrap": null,
  "_spec": "crawler",
  "_where": "/home/ggboy/文档/repositories/Practice-For-Node.js/Node.js爬虫系列/task1",
  "bugs": {
    "url": "https://github.com/bda-research/node-crawler/issues"
  },
  "dependencies": {
    "bottleneckp": "~1.1.2",
    "charset-parser": "^0.2.0",
    "cheerio": "^0.22.0",
    "iconv-lite": "^0.4.8",
    "lodash": "^4.17.4",
    "request": "~2.79.0",
    "seenreq": "^0.1.7",
    "type-is": "^1.6.14"
  },
  "description": "Crawler is a web spider written with Nodejs. It gives you the full power of jQuery on the server to parse a big number of pages as they are downloaded, asynchronously",
  "devDependencies": {
    "chai": "^2.3.0",
    "jsdom": "^9.6.0",
    "mocha": "^2.2.5",
    "mocha-testdata": "^1.1.0",
    "sinon": "^1.14.1",
    "whacko": "^0.19.1"
  },
  "directories": {
    "test": "tests"
  },
  "dist": {
    "shasum": "3a95f1bff46763e57ee6161d012b967f8e771684",
    "tarball": "https://registry.npmjs.org/crawler/-/crawler-1.0.5.tgz"
  },
  "engine-strict": {
    "node": ">=4.0.0"
  },
  "gitHead": "0f3a27d4e89d93fcf9c27a417adbba6fab9dde2e",
  "homepage": "https://github.com/bda-research/node-crawler",
  "keywords": [
    "dom",
    "javascript",
    "crawling",
    "spider",
    "scraper",
    "scraping",
    "jquery",
    "crawler",
    "nodejs"
  ],
  "licenses": [
    {
      "type": "MIT",
      "url": "http://github.com/bda-research/node-crawler/blob/master/LICENSE.txt"
    }
  ],
  "main": "./lib/crawler.js",
  "maintainers": [
    {
      "name": "darrenqc",
      "email": "darrenqc823@gmail.com"
    },
    {
      "name": "mike442144",
      "email": "mike442144@hotmail.com"
    },
    {
      "name": "paulvalla",
      "email": "bonjour@pol.ninja"
    },
    {
      "name": "sylvinus",
      "email": "sylvain@sylvainzimmer.com"
    }
  ],
  "name": "crawler",
  "optionalDependencies": {},
  "readme": "\n# node-crawler\n[![npm package](https://nodei.co/npm/crawler.png?downloads=true&downloadRank=true&stars=true)](https://nodei.co/npm/crawler/)\n\n[![build status](https://secure.travis-ci.org/bda-research/node-crawler.png)](https://travis-ci.org/bda-research/node-crawler)\n[![Dependency Status](https://david-dm.org/bda-research/node-crawler/status.svg)](https://david-dm.org/bda-research/node-crawler)\n[![Gitter](https://img.shields.io/badge/gitter-join_chat-blue.svg?style=flat-square)](https://gitter.im/node-crawler/discuss?utm_source=badge)\n\n\nMost powerful, popular and production crawling/scraping package for Node, happy hacking :). Now we are looking for a logo design, which need your help!\n\nFeatures:\n\n * server-side DOM & automatic jQuery insertion with Cheerio (default) or JSDOM\n * Configurable pool size and retries\n * Control rate limit\n * Priority queue of requests\n * forceUTF8 mode to let crawler deal for you with charset detection and conversion\n * Compatible with 4.x or newer version\n\nHere is the [CHANGELOG](https://github.com/bda-research/node-crawler/blob/master/CHANGELOG.md)\n\n# Get started\n\n## How to install\n\n\n    $ npm install crawler\n\n## Usage\n\n\n```javascript\nvar Crawler = require(\"crawler\");\n\nvar c = new Crawler({\n    maxConnections : 10,\n    // This will be called for each crawled page\n    callback : function (error, res, done) {\n        if(error){\n            console.log(error);\n        }else{\n            var $ = res.$;\n            // $ is Cheerio by default\n            //a lean implementation of core jQuery designed specifically for the server\n            console.log($(\"title\").text());\n        }\n        done();\n    }\n});\n\n// Queue just one URL, with default callback\nc.queue('http://www.amazon.com');\n\n// Queue a list of URLs\nc.queue(['http://www.google.com/','http://www.yahoo.com']);\n\n// Queue URLs with custom callbacks & parameters\nc.queue([{\n    uri: 'http://parishackers.org/',\n    jQuery: false,\n\n    // The global callback won't be called\n    callback: function (error, res, done) {\n        if(error){\n            console.log(error);\n        }else{\n            console.log('Grabbed', res.body.length, 'bytes');\n        }\n        done();\n    }\n}]);\n\n// Queue some HTML code directly without grabbing (mostly for tests)\nc.queue([{\n    html: '<p>This is a <strong>test</strong></p>'\n}]);\n```\n\n## Slow down\nUse `rateLimit` to slow down when you are visiting web sites.\n\n```javascript\nvar crawler = require(\"crawler\");\n\nvar c = new Crawler({\n    rateLimit: 1000, // `maxConnections` will be forced to 1\n    callback: function(err, res, done){\n       \tconsole.log(res.$(\"title\").text());\n        done();\n    }\n});\n\nc.queue(tasks);//between two tasks, minimum time gap is 1000 (ms)\n```\n\n## Options reference\n\n\nYou can pass these options to the Crawler() constructor if you want them to be global or as\nitems in the queue() calls if you want them to be specific to that item (overwriting global options)\n\nThis options list is a strict superset of [mikeal's request options](https://github.com/mikeal/request#requestoptions-callback) and will be directly passed to\nthe request() method.\n\nBasic request options:\n\n * `uri`: [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) The url you want to crawl.\n * `timeout` : [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) In milliseconds (Default 15000).\n * [All mikeal's requests options are accepted](https://github.com/mikeal/request#requestoptions-callback).\n\nCallbacks:\n\n * `callback(error, res, done)`: Function that will be called after a request was completed\n     * `error`: [Error](https://nodejs.org/api/errors.html)\n     * `res`: [http.IncomingMessage](https://nodejs.org/api/http.html#http_class_http_incomingmessage) A response of standard IncomingMessage includes `$` and `options`\n         * `res.statusCode`: [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) HTTP status code. E.G.`200`\n         * `res.body`: [Buffer](https://nodejs.org/api/buffer.html) | [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) HTTP response content which could be a html page, plain text or xml document e.g.\n         * `res.headers`: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object) HTTP response headers\n         * `res.request`: [Request](https://github.com/request/request)  An instance of Mikeal's `Request` instead of [http.ClientRequest](https://nodejs.org/api/http.html#http_class_http_clientrequest)\n             * `res.request.uri`: [urlObject](https://nodejs.org/api/url.html#url_url_strings_and_url_objects) HTTP request entity of parsed url\n             * `res.request.method`: [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) HTTP request method. E.G. `GET`\n             * `res.request.headers`: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object) HTTP request headers\n         * `res.options`: [Options](#options-reference) of this task\n         * `$`: [jQuery Selector](https://api.jquery.com/category/selectors/) A selector for  html or xml document.\n     * `done`: [Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function) It must be called when you've done your work in callback.\n\nSchedule options:\n\n * `maxConnections`: [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) Size of the worker pool (Default 10).\n * `rateLimit`: [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) Number of milliseconds to delay between each requests (Default 0).\n * `priorityRange`: [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) Range of acceptable priorities starting from 0 (Default 10).\n * `priority`: [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) Priority of this request (Default 5).\n\nRetry options:\n\n * `retries`: [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) Number of retries if the request fails (Default 3),\n * `retryTimeout`: [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type) Number of milliseconds to wait before retrying (Default 10000),\n\nServer-side DOM options:\n\n * `jQuery`: [Boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type)|[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)|[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object) Use `cheerio` with default configurations to inject document if true or \"cheerio\". Or use customized `cheerio` if an object with [Parser options](https://github.com/fb55/htmlparser2/wiki/Parser-options). Disable injecting jQuery selector if false. If you have memory leak issue in your project, use \"whacko\", an alternative parser,to avoid that. (Default true)\n\nCharset encoding:\n\n * `forceUTF8`: [Boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) If true crawler will get charset from HTTP headers or meta tag in html and convert it to UTF8 if necessary. Never worry about encoding anymore! (Default true),\n * `incomingEncoding`: [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) With forceUTF8: true to set encoding manually (Default null) so that crawler will not have to detect charset by itself. For example, `incomingEncoding : 'windows-1255'`. See [all supported encodings](https://github.com/ashtuchkin/iconv-lite/wiki/Supported-Encodings)\n\nCache:\n\n * `skipDuplicates`: [Boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) If true skips URIs that were already crawled, without even calling callback() (Default false). __This is not recommended__, it's better to handle outside `Crawler` use [seenreq](https://github.com/mike442144/seenreq)\n\nOther:\n\n * `rotateUA`: [Boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type) If true, `userAgent` should be an array and rotate it (Default false) \n * `userAgent`: [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)|[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array), If `rotateUA` is false, but `userAgent` is an array, crawler will use the first one.\n * `referer`: [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type) If truthy sets the HTTP referer header\n\n \n## Class:Crawler\n\n### Event: 'schedule'\n * `options` [Options](#options-reference)\n\nEmitted when a task is being added to scheduler.\n\n```javascript\ncrawler.on('schedule',function(options){\n    options.proxy = \"http://proxy:port\";\n});\n```\n\n### Event: 'limiterChange'\n * `options` [Options](#options-reference)\n * `limiter` [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)\n\nEmitted when limiter has been changed.\n\n### Event: 'request'\n * `options` [Options](#options-reference)\n\nEmitted when crawler is ready to send a request.\n\nIf you are going to modify options at last stage before requesting, just listen on it.\n\n```javascript\ncrawler.on('request',function(options){\n    options.qs.timestamp = new Date().getTime();\n});\n```\n\n### Event: 'drain'\n\nEmitted when queue is empty.\n\n```javascript\ncrawler.on('drain',function(){\n    // For example, release a connection to database.\n    db.end();// close connection to MySQL\n});\n```\n\n### crawler.queue(uri|options)\n * `uri` [String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type)\n * `options` [Options](#options-reference)\n\nEnqueue a task and wait for it to be executed.\n\n### crawler.queueSize\n * [Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type)\n\nSize of queue, read-only\n\n\n## Work with bottleneck\n\nControl rate limit for with limiter. All tasks submit to a limiter will abide the `rateLimit` and `maxConnections` restrictions of the limiter. `rateLimit` is the minimum time gap between two tasks. `maxConnections` is the maximum number of tasks that can be running at the same time. Limiters are independent of each other. One common use case is setting different limiters for different proxies. One thing is worth noticing, when `rateLimit` is set to a non-zero value, `maxConnections` will be forced to 1.\n\n```javascript\nvar crawler = require('crawler');\n\nvar c = new Crawler({\n    rateLimit: 2000,\n    maxConnections: 1,\n    callback: function(error, res, done) {\n        if(error) {\n            console.log(error)\n        } else {\n            var $ = res.$;\n            console.log($('title').text())\n        }\n        done();\n    }\n})\n\n// if you want to crawl some website with 2000ms gap between requests\nc.queue('http://www.somewebsite.com/page/1')\nc.queue('http://www.somewebsite.com/page/2')\nc.queue('http://www.somewebsite.com/page/3')\n\n// if you want to crawl some website using proxy with 2000ms gap between requests for each proxy\nc.queue({\n    uri:'http://www.somewebsite.com/page/1',\n    limiter:'proxy_1',\n    proxy:'proxy_1'\n})\nc.queue({\n    uri:'http://www.somewebsite.com/page/2',\n    limiter:'proxy_2',\n    proxy:'proxy_2'\n})\nc.queue({\n    uri:'http://www.somewebsite.com/page/3',\n    limiter:'proxy_3',\n    proxy:'proxy_3'\n})\nc.queue({\n    uri:'http://www.somewebsite.com/page/4',\n    limiter:'proxy_1',\n    proxy:'proxy_1'\n})\n```\n\n\n## Work with Cheerio or JSDOM\n\n\nCrawler by default use [Cheerio](https://github.com/cheeriojs/cheerio) instead of [JSDOM](https://github.com/tmpvar/jsdom). JSDOM is more robust, if you want to use JSDOM you will have to require it `require('jsdom')` in your own script before passing it to crawler.\n\n### Working with Cheerio\n```javascript\njQuery: true //(default)\n//OR\njQuery: 'cheerio'\n//OR\njQuery: {\n    name: 'cheerio',\n    options: {\n        normalizeWhitespace: true,\n        xmlMode: true\n    }\n}\n```\nThese parsing options are taken directly from [htmlparser2](https://github.com/fb55/htmlparser2/wiki/Parser-options), therefore any options that can be used in `htmlparser2` are valid in cheerio as well. The default options are:\n\n```javascript\n{\n    normalizeWhitespace: false,\n    xmlMode: false,\n    decodeEntities: true\n}\n```\n\nFor a full list of options and their effects, see [this](https://github.com/fb55/DomHandler) and\n[htmlparser2's options](https://github.com/fb55/htmlparser2/wiki/Parser-options).\n[source](https://github.com/cheeriojs/cheerio#loading)\n\n### Work with JSDOM\n\nIn order to work with JSDOM you will have to install it in your project folder `npm install jsdom`, and pass it to crawler.\n\n```javascript\nvar jsdom = require('jsdom');\nvar Crawler = require('crawler');\n\nvar c = new Crawler({\n    jQuery: jsdom\n});\n```\n\n# How to test\n\n## Install and run Httpbin\n\ncrawler use a local httpbin for testing purpose. You can install httpbin as a library from PyPI and run it as a WSGI app. For example, using Gunicorn:\n\n```bash\n$ pip install httpbin\n# launch httpbin as a daemon with 6 worker on localhost\n$ gunicorn httpbin:app -b 127.0.0.1:8000 -w 6 --daemon\n# Finally\n$ npm install && npm test\n```\n\n## Alternative: Docker\n\nAfter [installing Docker](http://docs.docker.com/), you can run:\n\n```bash\n# Builds the local test environment\n$ docker build -t node-crawler .\n\n# Runs tests\n$ docker run node-crawler sh -c \"gunicorn httpbin:app -b 127.0.0.1:8000 -w 6 --daemon && cd /usr/local/lib/node_modules/crawler && npm install && npm test\"\n\n# You can also ssh into the container for easier debugging\n$ docker run -i -t node-crawler bash\n```\n\n\n# Rough todolist\n\n * Introducing zombie to deal with page with complex ajax\n * Refactoring the code to be more maintainable\n * Make Sizzle tests pass (JSDOM bug? https://github.com/tmpvar/jsdom/issues#issue/81)\n * Promise support\n * Commander support\n * Middleware support\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/bda-research/node-crawler.git"
  },
  "scripts": {
    "test": "./node_modules/mocha/bin/mocha --reporter spec --bail --timeout 10000 tests/*.js"
  },
  "version": "1.0.5"
}
